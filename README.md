# Реализация реферальной системы на Django
## Тестирование с помощью Postman

Для удобного тестирования API можно использовать [данную коллекцию Postman](https://drxxmy-5957345.postman.co/workspace/Vladislav's-Workspace~02a601bf-0235-4b1a-80a7-4a7c52fa50ab/collection/47012835-635a47ba-bd9f-43dd-a848-4aa273fed1bf?action=share&source=copy-link&creator=47012835)

## Описание функционала API

### 1. Запрос кода авторизации

**Endpoint**: `POST /auth/request-code/`
**Описание**: Запрос отправки 4-значного кода авторизации на номер телефона
**Тело запроса**:

```json
{
    "phone_number": "79994445566"
}
```

**Ответы сервера**:

#### **Успех**

```json
{
    "status": "success",
    "message": "Код отправлен",
}
```

#### **Ошибка (Не указан номер телефона)**

```json
{
    "error": "Необходимо указать номер телефона"
}
```

### 2. Проверка кода авторизации

**Endpoint**: `POST /auth/verify-code/`
**Описание**: Проверка 4-значного кода для завершения авторизации
**Тело запроса**:

```json
{
    "phone_number": "79994445566",
    "code": "7543"
}
```

**Ответы сервера**:

#### **Успех**

```json
{
    "status": "success",
    "token": "<jwt_token>",
    "is_new_user": false
}
```

#### **Ошибка (Не указан номер телефона)**

```json
{
    "error": "Необходимо указать номер телефона"
}
```

#### **Ошибка (Не указан код подтверждения)**

```json
{
    "error": "Необходимо указать код подтверждения"
}
```

#### **Ошибка (Неверный код или код уже использован)**

```json
{
    "error": "Неверный код или код уже использован"
}
```

### 3. Получение профиля пользователя

**Endpoint**: `GET /profile/`
**Описание**: Получение сведений профиля пользователя
**Headers**: `Authorization: Bearer <jwt_token>`
**Ответ сервера**:

#### **Успех**

```json
{
    "phone_number": "79993334455",
    "invite_code": "yIFpAl",
    "activated_invite": null,
    "invited_users": [
        "79996667788"
    ]
}
```

### 4. Активация реферального кода

**Endpoint**: `POST /profile/activate-invite/`
**Описание**: Активация реферального кода
**Headers**: `Authorization: Bearer <jwt_token>`
**Тело запроса**:

```json
{
    "invite_code": "Tok2w1",
}
```

**Ответы сервера**:

#### **Успех**

```json
{
    "status": "success",
    "message": "Инвайт-код активирован"
}
```

#### **Ошибка (Инвайт-код уже активирован)**

```json
{
    "error": "Инвайт уже был активирован",
}
```

#### **Ошибка (Попытка активации собственного кода)**

```json
{
    "error": "Нельзя активировать собственный инвайт-код",
}
```

#### **Ошибка (Инвайт-код не найден)**

```json
{
    "error": "Инвайт-код не найден",
}
```
